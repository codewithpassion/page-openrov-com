"use strict";function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function a(r,i){try{var o=t[r](i),s=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(s).then(function(e){a("next",e)},function(e){a("throw",e)});e(s)}return a("next")})}}function objectifyForm(e){for(var t={},n=0;n<e.length;n++)t[e[n].name]=e[n].value;return t}function getData(e,t){var n=getVariant(e,t),a={first_name:e.firstName,last_name:e.lastName,company:null,line1:e.address1,line2:e.address2,city:e.city,state:"US"===e.country?e.usState:e.state,zip:e.zip,country:e.country.toLowerCase(),phone:e.phone};return{user_id:"5637c8d966e9ec03008989ef",buyer:{email:e.email,first_name:e.firstName,last_name:e.lastName,phone:e.phone,notes:e.notes},shipping_address:a,billing_address:Object.assign({},a,{zip:e.billingZip}),line_items:[{product_id:PRODUCT,variant_id:n,quantity:parseInt(e.quantity)}],payment_source:{card:{name:e.firstName+" "+e.lastName,number:e.ccNumber,exp_month:e.expDate.split("/")[0],exp_year:e.expDate.split("/")[1],cvc:e.cvc}},discount_codes:[]}}function getVariant(e,t){var n=[];for(var a in e)a.startsWith("option_")&&n.push(e[a]);n=n.sort();var r=!0,i=!1,o=void 0;try{for(var s,c=t[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var u=s.value;if(u.options.ids.sort().join()===n.join())return u.id}}catch(e){i=!0,o=e}finally{try{!r&&c.return&&c.return()}finally{if(i)throw o}}}var calculateShipping=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t,n){var a,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=objectifyForm(t.serializeArray()),r=getData(a,n),t.find(".loading").show(),e.next=5,$.ajax({async:!0,crossDomain:!0,url:"https://wt-f938a32f745f3589d64a35c208dd4c79-0.run.webtask.io/celry-access/calculate-shipping",method:"POST",headers:{"content-type":"application/json"},processData:!1,data:JSON.stringify(r)});case 5:i=e.sent,t.find("#shipping").val("$"+(i.shipping/100).toFixed(2)),t.find("#subtotal").val("$"+(i.subtotal/100).toFixed(2)),t.find("#tax").val("$"+(i.taxes/100).toFixed(2)),t.find("#total").val("$"+(i.total/100).toFixed(2)),t.find(".loading").hide();case 11:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),PRODUCT="57e9bd02726ecc1100f4204a";_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,n,a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.ajax({url:"https://wt-f938a32f745f3589d64a35c208dd4c79-0.run.webtask.io/celry-access/products/"+PRODUCT});case 2:t=e.sent,$("#description").html(t.data.description),n=t.data.options.map(function(e){return'<div class="form-group row"><label for="'+e.id+'" class="col-2 col-form-label">'+e.name+':</label><select class="form-control form-control-danger col-6" id="option_'+e.id+'" name="option_'+e.id+'" required><option selected value="" disabled>Select '+e.name+"</option>"+e.values.map(function(e){return'<option value="'+e.id+'">'+e.name+"</option>"}).join("")+"</select></div>"}).join(""),a=$("form#orderForm"),a.find("#options").append(n),a.find('#country option[value="US"]').attr("selected","true"),a.find("#country").change(function(e){"US"===e.currentTarget.options[e.target.selectedIndex].value?(a.find("#usState").removeClass("hidden-xs-up"),a.find("#state").addClass("hidden-xs-up")):(a.find("#state").removeClass("hidden-xs-up"),a.find("#usState").addClass("hidden-xs-up")),calculateShipping(a,t.data.variants)}),a.find("#options select").change(function(e){calculateShipping(a,t.data.variants)}),a.find("#quantity").change(function(e){calculateShipping(a,t.data.variants)}),a.find("#ccNumber").keypress(function(e){String.fromCharCode(e.which).match(/[0-9- ]/)||e.preventDefault()}),r=t.data.variants,a.on("submit",function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a.find('button[type="submit"]').attr("disabled",!0),n=objectifyForm(a.serializeArray()),i=getData(n,r),e.next=6,$.ajax({async:!0,crossDomain:!0,url:"https://api.trycelery.com/v2/orders/checkout",method:"POST",headers:{"content-type":"application/json"},processData:!1,data:JSON.stringify(i)});case 6:o=e.sent,console.log(o);case 8:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),$("#orderFormContainer").removeClass("invisible"),$("#loader-wrapper").addClass("loaded");case 16:case"end":return e.stop()}},e,void 0)}))();